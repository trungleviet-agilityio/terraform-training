name: Setup Python Build Environment
description: Setup Python and UV with caching for Lambda builds

inputs:
  python-version:
    description: 'Python version to install'
    required: false
    default: '3.13'
  uv-version:
    description: 'UV version to install'
    required: false
    default: 'latest'

runs:
  using: composite
  steps:
    - name: Setup Python
      uses: actions/setup-python@v5
      with:
        python-version: ${{ inputs.python-version }}

    - name: Install UV
      uses: astral-sh/setup-uv@v4
      with:
        version: ${{ inputs.uv-version }}

    - name: Cache UV Python installations
      uses: actions/cache@v4
      with:
        path: |
          ~/.local/share/uv/python
          ~/.cache/uv
        key: ${{ runner.os }}-uv-python-${{ hashFiles('practice/src/**/pyproject.toml') }}
        restore-keys: |
          ${{ runner.os }}-uv-python-

    - name: Install Python via UV
      shell: bash
      run: |
        uv python install ${{ inputs.python-version }}
